<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.winter.app.board.FileDAO">

	<!-- 파일 저장 -->
	<insert id="insertFile"
		parameterType="com.winter.app.board.FileVO">
		INSERT INTO upload_file
		(origin_name, saved_name, file_size,
		content_type)
		VALUES
		(#{originName}, #{savedName}, #{fileSize},
		#{contentType})
		<!-- // origin_name ⇄ originName, saved_name ⇄ savedName 자동 매핑 -->
	</insert>

	<!-- 파일 목록 조회 -->
	<select id="selectFileList"
		resultType="com.winter.app.board.FileVO">
		SELECT
		id AS id,
		origin_name AS originName,
		saved_name AS savedName,
		file_size AS fileSize,
		content_type AS contentType,
		reg_date AS regDate
		FROM upload_file
		ORDER BY id DESC
		<!-- // snake_case 컬럼을 camelCase 필드로 alias 지정 -->
	</select>

	<!-- 파일 상세 조회 -->
	<select id="selectFile" parameterType="long"
		resultType="com.winter.app.board.FileVO">
		SELECT
		id AS id,
		origin_name AS originName,
		saved_name AS savedName,
		file_size AS fileSize,
		content_type AS contentType,
		reg_date AS regDate
		FROM upload_file
		WHERE id = #{id}
		<!-- // #{id} 파라미터는 DAO 메서드의 매개변수와 이름/타입이 일치해야 함 -->
	</select>

	<!-- 필요 시: 물리 삭제(논리삭제 컬럼 없을 때) -->
	<delete id="deleteFile" parameterType="long">
		DELETE FROM upload_file
		WHERE id = #{id}
	</delete>

</mapper>
